@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="~/css/admin.css" asp-append-version="true">
<link rel="stylesheet" href="~/css/dashboard.css" asp-append-version="true" />

<div class="container mt-5">
    <h5 class="text-center">@ViewData["Title"]</h5>

    <!-- Tabs for navigation -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="orders-tab" data-bs-toggle="tab" href="#orders" role="tab" aria-controls="orders" aria-selected="false">Đơn hàng</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="invoices-tab" data-bs-toggle="tab" href="#invoices" role="tab" aria-controls="invoices" aria-selected="false">Phiếu nhập</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="monthly-tab" data-bs-toggle="tab" href="#monthly" role="tab" aria-controls="monthly" aria-selected="true">Sản phẩm theo tháng</a>
        </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content mt-3">

        <!-- Tab 2: Đơn hàng -->
        <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
            <h4 class="text-center">Biểu đồ đơn hàng</h4>
            <canvas id="ordersChart" width="300" height="200"></canvas>

        </div>
        <!-- Tab 3: Phiếu nhập -->
        <div class="tab-pane fade" id="invoices" role="tabpanel" aria-labelledby="invoices-tab">
            <h4 class="text-center">Biểu đồ phiếu nhập</h4>
            <canvas id="invoicesChart" width="400" height="200"></canvas>
        </div>
        <!-- Tab 1: Sản phẩm theo tháng -->
        <div class="tab-pane fade show active" id="monthly" role="tabpanel" aria-labelledby="monthly-tab">
            <h4 class="text-center">Biểu đồ sản phẩm bán theo tháng</h4>
            <canvas id="productSalesChart" width="400" height="200"></canvas>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>

    fetch('/Admin/Home/GetDonHang')
        .then(response => response.json())
        .then(data => {

            const months = data.map(item => `Tháng ${item.month}`);
            const orderCounts = data.map(item => item.orderCount);
            var ctx = document.getElementById('ordersChart').getContext('2d');
            var ordersChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Số đơn hàng',
                        data: orderCounts,
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        })
         .catch(error => console.error('Error fetching data:', error));
    fetch('/Admin/Home/GetPhieuNhap')
        .then(response => response.json())
        .then(data => {
            const months = data.map(item => `Tháng ${item.month}`);
            const invoiceCounts = data.map(item => item.invoiceCount);
            var ctx = document.getElementById('invoicesChart').getContext('2d');
            var invoicesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Số phiếu nhập',
                        data: invoiceCounts,
                        backgroundColor: 'rgba(255, 159, 64, 0.2)',
                        borderColor: 'rgba(255, 159, 64, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        })


</script>